{"mappings":"AAAA,MAAMA,EAASC,SAASC,cAAc,WAChCC,EAAQF,SAASC,cAAc,UAC/BE,EAAYH,SAASC,cAAc,cACnCG,EAAgB,CAAC,KAAM,IAAK,IAAK,KACvC,IAAIC,GAAW,EACXC,EAASC,eAAeC,QAAQ,UACpCC,QAAQC,IAAIJ,GAGZ,MAAMK,EAAK,IAAIC,UAAU,2CAA2CN,KAwDpE,SAASO,EAAaC,GAClB,MAAMC,EAAaf,SAASgB,cAAc,KAC1CD,EAAWE,YAAcH,EACzBf,EAAOmB,OAAOH,GACdI,OAAOC,SAAS,CACZC,IAAKlB,EAAUmB,aAAeH,OAAOI,YACrCC,SAAU,UAElB,CA/DAb,EAAGc,OAAS,KAERpB,GAAW,CAAI,EAEnBM,EAAGe,QAAU,KAETrB,GAAW,CAAK,EAEpBM,EAAGgB,UAAYC,IACX,MAAMC,EAAOC,KAAKC,MAAMH,EAASI,MACjC,OAAQH,EAAKI,SACT,IAAK,QACD1B,eAAe2B,QAAQ,SAAUL,EAAKG,MAEtC,MAEJ,IAAK,MACDnB,EAAagB,EAAKG,MAClB,MAEJ,IAAK,SA6Cb,SAAmBG,EAAUC,GACzB,MAAMC,EAAW,yEACSD,+BACXD,oDACfjC,EAAMoC,UAAYD,EAClB,MAAME,EAAOvC,SAASC,cAAc,SAC9BuC,EAAYD,EAAKtC,cAAc,SACrCuC,EAAUC,QACVF,EAAKG,iBAAiB,UAAWC,IAC7BA,EAAEC,iBACFjC,EAAGkC,KAAKL,EAAUM,OAClB5C,EAAMoC,UAAY,KAE1B,CAzDYS,CAAUlB,EAAKmB,KAAMnB,EAAKG,MAC1B,MAEJ,IAAK,SACDjC,EAAOuC,UAAY,GAa/B,SAAmBW,GACf,GAAGA,EAAG,CACF,MAAMC,EAAO,6DACbhD,EAAMoC,UAAYY,EAClB,MAAMC,EAAOnD,SAASC,cAAc,WACpC,IAAImD,EAAE,EACaC,aAAY,KAC3BF,EAAOlC,YAAcb,EAAcgD,GACnCA,EAAIA,EAAE,EAAIA,GAAG,EAAI,CAAC,GACnB,IACP,MACIE,cAAcC,cACdrD,EAAMoC,UAAY,EAG1B,CA3BYkB,CAAU3B,EAAKG,MACf,MAEJ,QACInB,EAAagB,GAErB","sources":["src/js/client.js"],"sourcesContent":["const output = document.querySelector(\"#output\");\nconst input = document.querySelector(\"#input\");\nconst mainframe = document.querySelector(\".mainframe\");\nconst rollerSymbols = ['\\\\', '|', '/', '―'];\nlet isOnline = false;\nlet userID = sessionStorage.getItem('userID');\nconsole.log(userID);\n\n//const ws = new WebSocket(`ws://localhost:8080`);\nconst ws = new WebSocket(`ws://salty-bayou-10932.herokuapp.com?id=${userID}`);\nws.onopen = () => {\n    //writeMessage(\"Произошло подключение к сереверу\");\n    isOnline = true;\n};\nws.onclose = () => {\n    //writeMessage(\"Произошло отключение от серевера\")\n    isOnline = false;\n};\nws.onmessage = response => {\n    const info = JSON.parse(response.data);\n    switch (info.command) {\n        case 'setID':\n            sessionStorage.setItem('userID', info.data);\n            //ws.send('ready');\n            break;\n\n        case 'msg':\n            writeMessage(info.data);\n            break;\n\n        case 'input':\n            inputData(info.type, info.data);\n            break;\n\n        case 'loader':\n            output.innerHTML = '';\n            getLaoder(info.data);\n            break;\n\n        default:\n            writeMessage(info);\n        break;\n    }\n\n    \n    }\n\n\nfunction getLaoder(b){\n    if(b) {\n        const loader='<p>Идет поиск собеседника <span class=\"roller\"></span></p>';\n        input.innerHTML = loader;\n        const roller=document.querySelector('.roller');\n        let i=0;\n        let rollInterval = setInterval(() => {\n            roller.textContent = rollerSymbols[i];\n            i = i<3 ? i+=1 : 0;\n        }, 100);\n    } else {\n        clearInterval(rollInterval);\n        input.innerHTML = '';\n    }\n    \n}\n\nfunction writeMessage(n){\n    const staticLine = document.createElement(\"p\");\n    staticLine.textContent = n;\n    output.append(staticLine);\n    window.scrollTo({\n        top: mainframe.scrollHeight - window.innerHeight,\n        behavior: 'smooth'\n    });\n}\n\nfunction inputData(dataType, dataLabel) {\n    const formHtml = `<form class=\"one-string-form\" id=\"form\">\n    <label for=\"input-data\">${dataLabel}</label>\n    <input type=\"${dataType}\" name = \"input-data\" class=\"input-data\"></form>`;\n    input.innerHTML = formHtml;\n    const form = document.querySelector('#form');\n    const formField = form.querySelector('input');\n    formField.focus();\n    form.addEventListener('submit', (e) => {\n        e.preventDefault();\n        ws.send(formField.value);\n        input.innerHTML = '';\n    })\n}"],"names":["$2875906d2ea62390$var$output","document","querySelector","$2875906d2ea62390$var$input","$2875906d2ea62390$var$mainframe","$2875906d2ea62390$var$rollerSymbols","$2875906d2ea62390$var$isOnline","$2875906d2ea62390$var$userID","sessionStorage","getItem","console","log","$2875906d2ea62390$var$ws","WebSocket","$2875906d2ea62390$var$writeMessage","n","staticLine","createElement","textContent","append","window","scrollTo","top","scrollHeight","innerHeight","behavior","onopen","onclose","onmessage","response","info","JSON","parse","data","command","setItem","dataType","dataLabel","formHtml","innerHTML","form","formField","focus","addEventListener","e","preventDefault","send","value","$2875906d2ea62390$var$inputData","type","b","loader","roller","i","setInterval","clearInterval","rollInterval","$2875906d2ea62390$var$getLaoder"],"version":3,"file":"client.2ef20613.js.map"}