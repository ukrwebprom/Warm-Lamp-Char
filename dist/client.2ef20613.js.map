{"mappings":"AAAA,MAAMA,EAASC,SAASC,cAAc,WAChCC,EAAQF,SAASC,cAAc,UAC/BE,EAAYH,SAASC,cAAc,cACnCG,EAAgB,CAAC,KAAM,IAAK,IAAK,KACvC,IAAIC,GAAW,EACXC,EAASC,eAAeC,QAAQ,UACpCC,QAAQC,IAAIJ,GAGZ,MAAMK,EAAK,IAAIC,UAAU,2CAA2CN,KAwDpE,SAASO,EAAaC,GAClB,MAAMC,EAAaf,SAASgB,cAAc,KAC1CD,EAAWE,YAAcH,EACzBf,EAAOmB,OAAOH,GACdI,OAAOC,SAAS,CACZC,IAAKlB,EAAUmB,aAAeH,OAAOI,YACrCC,SAAU,UAElB,CA/DAb,EAAGc,OAAS,KAERpB,GAAW,CAAI,EAEnBM,EAAGe,QAAU,KAETrB,GAAW,CAAK,EAEpBM,EAAGgB,UAAYC,IACX,MAAMC,EAAOC,KAAKC,MAAMH,EAASI,MACjC,OAAQH,EAAKI,SACT,IAAK,QACD1B,eAAe2B,QAAQ,SAAUL,EAAKG,MAEtC,MAEJ,IAAK,MACDnB,EAAagB,EAAKG,MAClB,MAEJ,IAAK,SA6Cb,SAAmBG,EAAUC,GACzB,MAAMC,EAAW,yEAGjBD,+BACaD,oDACbjC,EAAuBoC,UAAcD,EACrC,MAAAE,EAAUvC,SAAKC,cAAA,SACVuC,EAAAD,EAAiBtC,cAAiB,S,EACjCwC,Q,EACFC,iBAAA,UAAOC,IACPA,EAAAC,iBACJjC,EAAAkC,KAAAL,EAAAM,OACJ5C,EAAAoC,UAAA,K,CAzDYS,CAAUlB,EAAKmB,KAAMnB,EAAKG,MAC1B,MAEJ,IAAK,SACDjC,EAAOuC,UAAY,GAa/B,SAAmBW,GACf,GAAGA,EAAG,CACF,MAAMC,EAAO,6DACbhD,EAAMoC,UAAYY,EAClB,MAAMC,EAAOnD,SAASC,cAAc,WACpC,IAAImD,EAAE,EACaC,aAAY,KAC3BF,EAAOlC,YAAcb,EAAcgD,GACnCA,EAAIA,EAAE,EAAIA,GAAG,EAAI,CAAC,GACnB,IACP,MACIE,cAAcC,cACdrD,EAAMoC,UAAY,EAG1B,CA3BYkB,CAAU3B,EAAKG,MACf,MAEJ,QACInB,EAAagB,GAErB","sources":["src/js/client.js"],"sourcesContent":["const output = document.querySelector(\"#output\");\r\nconst input = document.querySelector(\"#input\");\r\nconst mainframe = document.querySelector(\".mainframe\");\r\nconst rollerSymbols = ['\\\\', '|', '/', '―'];\r\nlet isOnline = false;\r\nlet userID = sessionStorage.getItem('userID');\r\nconsole.log(userID);\r\n\r\n//const ws = new WebSocket(`ws://localhost:8080`);\r\nconst ws = new WebSocket(`ws://salty-bayou-10932.herokuapp.com?id=${userID}`);\r\nws.onopen = () => {\r\n    //writeMessage(\"Произошло подключение к сереверу\");\r\n    isOnline = true;\r\n};\r\nws.onclose = () => {\r\n    //writeMessage(\"Произошло отключение от серевера\")\r\n    isOnline = false;\r\n};\r\nws.onmessage = response => {\r\n    const info = JSON.parse(response.data);\r\n    switch (info.command) {\r\n        case 'setID':\r\n            sessionStorage.setItem('userID', info.data);\r\n            //ws.send('ready');\r\n            break;\r\n\r\n        case 'msg':\r\n            writeMessage(info.data);\r\n            break;\r\n\r\n        case 'input':\r\n            inputData(info.type, info.data);\r\n            break;\r\n\r\n        case 'loader':\r\n            output.innerHTML = '';\r\n            getLaoder(info.data);\r\n            break;\r\n\r\n        default:\r\n            writeMessage(info);\r\n        break;\r\n    }\r\n\r\n    \r\n    }\r\n\r\n\r\nfunction getLaoder(b){\r\n    if(b) {\r\n        const loader='<p>Идет поиск собеседника <span class=\"roller\"></span></p>';\r\n        input.innerHTML = loader;\r\n        const roller=document.querySelector('.roller');\r\n        let i=0;\r\n        let rollInterval = setInterval(() => {\r\n            roller.textContent = rollerSymbols[i];\r\n            i = i<3 ? i+=1 : 0;\r\n        }, 100);\r\n    } else {\r\n        clearInterval(rollInterval);\r\n        input.innerHTML = '';\r\n    }\r\n    \r\n}\r\n\r\nfunction writeMessage(n){\r\n    const staticLine = document.createElement(\"p\");\r\n    staticLine.textContent = n;\r\n    output.append(staticLine);\r\n    window.scrollTo({\r\n        top: mainframe.scrollHeight - window.innerHeight,\r\n        behavior: 'smooth'\r\n    });\r\n}\r\n\r\nfunction inputData(dataType, dataLabel) {\r\n    const formHtml = `<form class=\"one-string-form\" id=\"form\">\r\n    <label for=\"input-data\">${dataLabel}</label>\r\n    <input type=\"${dataType}\" name = \"input-data\" class=\"input-data\"></form>`;\r\n    input.innerHTML = formHtml;\r\n    const form = document.querySelector('#form');\r\n    const formField = form.querySelector('input');\r\n    formField.focus();\r\n    form.addEventListener('submit', (e) => {\r\n        e.preventDefault();\r\n        ws.send(formField.value);\r\n        input.innerHTML = '';\r\n    })\r\n}"],"names":["$2875906d2ea62390$var$output","document","querySelector","$2875906d2ea62390$var$input","$2875906d2ea62390$var$mainframe","$2875906d2ea62390$var$rollerSymbols","$2875906d2ea62390$var$isOnline","$2875906d2ea62390$var$userID","sessionStorage","getItem","console","log","$2875906d2ea62390$var$ws","WebSocket","$2875906d2ea62390$var$writeMessage","n","staticLine","createElement","textContent","append","window","scrollTo","top","scrollHeight","innerHeight","behavior","onopen","onclose","onmessage","response","info","JSON","parse","data","command","setItem","dataType","dataLabel","formHtml","innerHTML","form","formField","focus","addEventListener","e","preventDefault","send","value","$2875906d2ea62390$var$inputData","type","b","loader","roller","i","setInterval","clearInterval","rollInterval","$2875906d2ea62390$var$getLaoder"],"version":3,"file":"client.2ef20613.js.map"}